#include "main.h"
#include "pads.h"

#include "fpga_mul.h"

/*
 ******************************************************************************
 * DEFINES
 ******************************************************************************
 */

/*
 ******************************************************************************
 * EXTERNS
 ******************************************************************************
 */

/*
 ******************************************************************************
 * GLOBAL VARIABLES
 ******************************************************************************
 */

/*
 ******************************************************************************
 * PROTOTYPES
 ******************************************************************************
 */

/*
 *******************************************************************************
 *******************************************************************************
 * LOCAL FUNCTIONS
 *******************************************************************************
 *******************************************************************************
 */

/*
 *******************************************************************************
 * EXPORTED FUNCTIONS
 *******************************************************************************
 */
/**
 *
 */
void MulObjectInit(MtrxMul *mulp) {
  mulp->state = MTRXMUL_STOP;
}

/**
 *
 */
void MulStart(MtrxMul *mulp, const FPGADriver *fpgap) {

  mulp->cmd  = fpgap->memspace->cmd[0];
  mulp->mtrx = fpgap->memspace->mtrx[0];

  for (size_t i=0; i<FPGA_MTRX_CNT; i++) {
    mulp->empty |= 1 << i;
  }

  mulp->state = MTRXMUL_READY;
}

/**
 *
 */
void MulStop(MtrxMul *mulp) {
  mulp->state = MTRXMUL_STOP;

  mulp->cmd = NULL;
  mulp->mtrx = NULL;
  mulp->empty = 0;
}



